---
id: formula-list
title: List of Formulas and Functions
---

import useBaseUrl from "@docusaurus/useBaseUrl"; // Add to the top of the file below the front matter.

ValQ supports many traditional user-friendly functions that allow you
to create complex models. You may recognize many of these from your
experience with Microsoft Excel.

## Logical Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/if")}>IF</a>
      </td>
      <td>If( logical_test, value_if_true, value_if_false )</td>
      <td>
        Checks whether a condition is met, and returns one value if TRUE, and
        another value if FALSE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/switch")}>SWITCH</a>
      </td>
      <td>
        SWITCH ( expression, value1, result1, value2, result2, ... value_n,
        result_n [, default] )
      </td>
      <td>
        Evaluates an expression against a list of values and returns the result
        corresponding to the first matching value. If there is no match, an
        optional default value is returned.
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/and")}>AND</a>
      </td>
      <td>AND( logical_test1, [logical_test2], ... )</td>
      <td>
        Checks whether all the arguments are TRUE, and returns TRUE if all
        arguments are TRUE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/or")}>OR</a>
      </td>
      <td>OR( logical_test1, [logical_test2], ... )</td>
      <td>
        Checks whether any of the arguments are TRUE, and returns TRUE or FALSE.
        Returns FALSE only if all arguments are FALSE
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/not")}>NOT</a>
      </td>
      <td>NOT( logical_test )</td>
      <td>Changes FALSE to TRUE, or TRUE to FALSE</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/xor")}>XOR</a>
      </td>
      <td>XOR( logical_test1, [logical_test2], ... )</td>
      <td>Returns a logical &#39;Exclusive Or&#39; of all arguments</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/isnan")}>ISNAN</a>
      </td>
      <td>ISNAN (value1,value2)</td>
      <td> Returns a default value if the value in the node is an error.</td>
    </tr>
  </tbody>
</table>

## Logical Operators

<table>
  <thead>
    <tr>
      <th>
        <strong>OPERATORS</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&&</td>
      <td>
        Logical <a href={useBaseUrl("references/formulas/and")}>AND</a>
      </td>
    </tr>
    <tr>
      <td>||</td>
      <td>
        Logical <a href={useBaseUrl("references/formulas/or")}>OR</a>
      </td>
    </tr>
  </tbody>
</table>

## Math Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/sum")}>SUM</a>
      </td>
      <td>Sum(value1,[value2]....)</td>
      <td>
        Add all numbers in the arguments, which can be numbers or node
        references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/average")}>AVERAGE</a>
      </td>
      <td>Average(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments, which can be
        numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/averageexzero")}>
          AVERAGEEXZERO
        </a>
      </td>
      <td>AverageExZero(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding zeros,
        which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/averageexneg")}>
          AVERAGEEXNEG
        </a>
      </td>
      <td>AverageExNeg(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding
        negatives, which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/averageexzeroneg")}>
          AVERAGEEXZERONEG
        </a>
      </td>
      <td>AverageExZeroNeg(value1,[value2]....)</td>
      <td>
        Returns the average (arithmetic mean) of its arguments excluding zeros
        and negatives, which can be numbers or node references
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/count")}>COUNT</a>
      </td>
      <td>Count(value1,[value2]....)</td>
      <td>Counts the number of items in a range</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/abs")}>ABS</a>
      </td>
      <td>ABS(value)</td>
      <td>Returns the absolute value of a number, a number without its sign</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/min")}>MIN</a>
      </td>
      <td>Min(value1,[value2]....)</td>
      <td>
        Returns the smallest number in a set of values. Node references also
        accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/max")}>MAX</a>
      </td>
      <td>Max(value1,[value2]....)</td>
      <td>
        Returns the largest number in a set of values. Node references also
        accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/power")}>POWER</a>
      </td>
      <td>POW(value,power)</td>
      <td>Returns the result of a number raised to a power</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/sqrt")}>SQRT</a>
      </td>
      <td>SQRT(value)</td>
      <td>Returns the square root of a number</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/exp")}>EXP</a>
      </td>
      <td>EXP(value)</td>
      <td>Returns e raised to the power of a given number</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/log")}>LOG</a>
      </td>
      <td>LOG(value,base)</td>
      <td>Returns the logarithm of a number to the base you specify</td>
    </tr>
  </tbody>
</table>

## Finance Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/irr")}>IRR</a>
      </td>
      <td>IRR (Values, [Guess])</td>
      <td>
        Returns the internal rate of return for a series of cash flows. Node
        references also accepted as arguments
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/npv")}>NPV</a>
      </td>
      <td>NPV (Rate, value1, [value2], ...)</td>
      <td>
        Returns the net present value of an investment based on a discount rate
        and a series of future payments (negative values) and income (positive
        values)
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/pmt")}>PMT</a>
      </td>
      <td>PMT(Rate, Nper, PV, [FV], [Type])</td>
      <td>
        Calculates the payment for a loan based on constant payments and a
        constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/ipmt")}>IPMT</a>
      </td>
      <td>IPMT (Rate, Per, Nper, PV, [FV], [Type])</td>
      <td>
        Returns the interest payment for a given period for an investment,based
        on periodic, constant payments and a constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/fv")}>FV</a>
      </td>
      <td>FV (Rate, Nper, [Pmt], PV, [Type])</td>
      <td>
        Returns the future value of an investment based on periodic, constant
        payments and a constant interest rate
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/pv")}>PV</a>
      </td>
      <td>PV(Rate, Nper, [Pmt], FV, [Type])</td>
      <td>Returns the present value of an investment</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/cumipmt")}>CUMIPMT</a>
      </td>
      <td>CUMIPMT (Rate, Nper, PV, start_period, end_period, Type)</td>
      <td>Returns the cumulative interest paid between two periods</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/cumprinc")}>CUMPRINC</a>
      </td>
      <td>CUMPRINC (Rate, Nper, PV, start_period, end_period, Type)</td>
      <td>
        Returns the cumulative principal paid on a loan between two periods
      </td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/rate")}>RATE</a>
      </td>
      <td>RATE(Nper, PMT, PV, [FV], [Type], [Guess])</td>
      <td>Returns the interest rate per period of a loan or an investment.</td>
    </tr>
  </tbody>
</table>{" "}

## Range Functions

<table>
  <thead>
    <tr>
      <th>
        <strong>NAME</strong>
      </th>
      <th>
        <strong>SYNTAX</strong>
      </th>
      <th>
        <strong>DESCRIPTION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/range")}>Range</a>
      </td>
      <td>.Range(start_index,end_index)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/lastnperiods")}>
          LastNPeriods
        </a>
      </td>
      <td>.LastNPeriods(n)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/get")}>Get</a>
      </td>
      <td>.Get(period_index)</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/foreach")}>ForEach</a>
      </td>
      <td>ForEach(Array,Iterator)</td>
      <td>Iterator function</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/findbyid")}>findByID</a>
      </td>
      <td>findByID("ID match string")</td>
      <td>Tagging/Grouping function</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/findbytitle")}>
          findByTitle
        </a>
      </td>
      <td>findByTitle("Title match string")</td>
      <td>Tagging/Grouping function</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/getcurrentrange")}>
          GETCURRENTRANGE
        </a>
      </td>
      <td>DS.(SERIES).GETCURRENTRANGE()</td>
      <td>Current range based on period selection</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/getrowvalue")}>
          GETROWVALUE
        </a>
      </td>
      <td>DS.(SERIES).GETROWVALUE(source_key)</td>
      <td>Value of source key row</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/thisid")}>THIS_ID</a>
      </td>
      <td>DS.(SERIES).THIS_ID</td>
      <td></td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/thissourcekey")}>
          THIS_SOURCE_KEY
        </a>
      </td>
      <td>DS.(SERIES).THIS_SOURCE_KEY</td>
      <td>Returns the value of the row with node id as source key</td>
    </tr>
  </tbody>
</table>

## Static Identifiers And Other Formats

<table>
  <thead>
    <tr>
      <th>
        <strong>CONSTANTS</strong>
      </th>
      <th>
        <strong>EXPLANATION</strong>
      </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/this")}>THIS</a>
      </td>
      <td>Current Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/me")}>ME</a>
      </td>
      <td>Current Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/current_series")}>
          CURRENT_SERIES
        </a>
      </td>
      <td>Current series label</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/current_series_id")}>
          CURRENT_SERIES_ID{" "}
        </a>
      </td>
      <td>Current series id</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/current_period_index")}>
          CURRENT_PERIOD_INDEX
        </a>
      </td>
      <td>Current period index</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/current_node_value")}>
          CURRENT_NODE_VALUE{" "}
        </a>
      </td>
      <td>Current node previous period values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/sim_from_to_index")}>
          SIM_FROM_INDEX
        </a>
      </td>
      <td>Sim From period index</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/sim_from_to_index")}>
          SIM_TO_INDEX
        </a>
      </td>
      <td>Sim To period index</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].PARENT
        </a>
      </td>
      <td>Parent Node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].CHILDREN
        </a>
      </td>
      <td>Node children</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act
        </a>
      </td>
      <td>Simulated Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt{" "}
        </a>
      </td>
      <td>Comparison Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base{" "}
        </a>
      </td>
      <td>Baseline Series of the node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].ALL_PERIODS
        </a>
      </td>
      <td>Returns all Period values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].SIM_PERIODS
        </a>
      </td>
      <td>Returns simulation period values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act.ALL_PERIODS
        </a>
      </td>
      <td>Returns all period values of Simulated Series,</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt.ALL_PERIODS{" "}
        </a>
      </td>
      <td>Returns all period values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base.ALL_PERIODS
        </a>
      </td>
      <td>Returns all period values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act.SIM_PERIODS{" "}
        </a>
      </td>
      <td>Returns simulation period values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt.SIM_PERIODS{" "}
        </a>
      </td>
      <td>Returns simulation period values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base.SIM_PERIODS
        </a>
      </td>
      <td>Returns simulation period values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt.Range(start_index,end_index)
        </a>
      </td>
      <td>Returns selected range values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].Get(period_index){" "}
        </a>
      </td>
      <td>Returns selected period value</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act.Get(period_index)
        </a>
      </td>
      <td>Returns selected period value of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base.Get(period_index){" "}
        </a>
      </td>
      <td>Returns selected period value of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt.Get(period_index)
        </a>
      </td>
      <td>Returns selected period value of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].act.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Simulated Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].base.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Baseline Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].tgt.LastNPeriods(n){" "}
        </a>
      </td>
      <td>Returns selected range values of Comparison Series</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].TOTAL{" "}
        </a>
      </td>
      <td>Returns the all period aggregated value of node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].PTD{" "}
        </a>
      </td>
      <td>Returns the period to date aggregated value of node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].SEL{" "}
        </a>
      </td>
      <td>Returns the simulation periods aggregated value of node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].ID{" "}
        </a>
      </td>
      <td>Returns node id</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].VISIBLE_CHILDREN{" "}
        </a>
      </td>
      <td>Returns all visible children of a node</td>
    </tr>
    <tr>
      <td>
        <a href={useBaseUrl("references/formulas/node-properties")}>
          [NODE].HIDDEN_CHILDREN{" "}
        </a>
      </td>
      <td>Returns all hidden children of a node</td>
    </tr>
  </tbody>
</table>

## Other Operators

<div style={{textAlign: 'justify'}} className="table">


| OPERATORS | DESCRIPTION                            |
| --------- | -------------------------------------- |
| ()        | Parenthesis                            |
| +, -      | plus,minus(-1) sign                    |
| \*, /     | Multiplication, Division               |
| +, -      | Addition, Subtraction                  |
| ==, !=    | Equal to, Not equal to                 |
| >, >=     | Greater than, Greater than or equal to |
| <, <=     | Less than, Less than or equal to       |

</div>

